äº†è§£ã—ã¾ã—ãŸã€‚
ä»¥ä¸‹ã®ã‚ˆã†ãªè¦ä»¶ã§ã€**ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†ã¨è¨­è¨ˆ**ã‚’æ•´ç†ã—ã¦ã”èª¬æ˜ã—ã¾ã™ã€‚

---

## âœ… è¦ä»¶ã®ã¾ã¨ã‚

| è¦ç´       | å†…å®¹                                               |
| ------- | ------------------------------------------------ |
| ãƒœã‚¿ãƒ³     | ãƒ˜ãƒƒãƒ€ãƒ¼ã«ã‚ã‚Šã€æŠ¼ä¸‹æ™‚ã«ã‚µã‚¤ãƒ‰ãƒ‘ãƒãƒ«ã‚’é–‹ã                            |
| APIå‘¼ã³å‡ºã— | ãƒœã‚¿ãƒ³æŠ¼ä¸‹ã¨åŒæ™‚ã«å®Ÿè¡Œï¼ˆã‚µã‚¤ãƒ‰ãƒ‘ãƒãƒ«å´ã§ã¯å‘¼ã°ãªã„ï¼‰                       |
| storeç™»éŒ² | APIãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’Vuexã« `commit` ã§ä¿å­˜                      |
| ã‚µã‚¤ãƒ‰ãƒ‘ãƒãƒ«  | storeã®stateã‚’èª­ã¿è¾¼ã‚“ã§è¡¨ç¤ºï¼ˆåˆå›é–‹æ™‚ã®ã¿fetchã•ã‚Œã‚‹ï¼‰              |
| ä½¿ç”¨æ§‹æˆ    | Vue 3 + defineComponent + Composition API + Vuex |

---

## âœ… ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«æ§‹æˆã¨å‡¦ç†ãƒ•ãƒ­ãƒ¼

```text
[Header] â† ãƒœã‚¿ãƒ³æŠ¼ä¸‹
   â†“
dispatch("openPanel")
   â”œâ”€ state: isPanelVisible = true
   â””â”€ APIå‘¼ã³å‡ºã— â†’ store ã«ãƒ‡ãƒ¼ã‚¿ commit

[SidePanel]
  è¡¨ç¤ºçŠ¶æ…‹ï¼ˆv-if or v-showï¼‰ã§ãƒã‚¦ãƒ³ãƒˆ
  â†’ ãƒã‚¦ãƒ³ãƒˆå¾Œã¯ store ã®ãƒ‡ãƒ¼ã‚¿ã‚’å‚ç…§ã—ã¦è¡¨ç¤º
```

---

## âœ… 1. store ã«ãƒ‘ãƒãƒ«è¡¨ç¤ºçŠ¶æ…‹ + DTOãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒ

```ts
export interface PanelState {
  isPanelVisible: boolean
  panelData: MyDto[] | null
}

const panelModule: Module<PanelState, RootState> = {
  namespaced: true,

  state: () => ({
    isPanelVisible: false,
    panelData: null,
  }),

  mutations: {
    openPanel(state) {
      state.isPanelVisible = true
    },
    closePanel(state) {
      state.isPanelVisible = false
    },
    setPanelData(state, data: MyDto[]) {
      state.panelData = data
    },
  },
}
```

---

## âœ… 2. ãƒ˜ãƒƒãƒ€ãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã®å‡¦ç†ï¼ˆAPIå‘¼ã³å‡ºã—ï¼‹ãƒ‘ãƒãƒ«è¡¨ç¤ºï¼‰

```ts
const openSidePanel = async () => {
  store.commit('panel/openPanel')

  const res = await fetch('/api/panel-data')
  const data: MyDto[] = await res.json()

  store.commit('panel/setPanelData', data)
}
```

> ğŸ’¡ã€ŒAPIãŒçµ‚ã‚ã‚‹ã¾ã§ãƒ‘ãƒãƒ«ã‚’è¡¨ç¤ºã—ãªã„ã€å ´åˆã¯ `await` å¾Œã« `openPanel` ã—ã¦ã‚‚OK

---

## âœ… 3. ã‚µã‚¤ãƒ‰ãƒ‘ãƒãƒ«ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆdefineComponentï¼‰

```ts
<script lang="ts">
import { defineComponent, computed } from 'vue'
import { useStore } from 'vuex'
import { RootState } from '@/store'

export default defineComponent({
  name: 'SidePanel',

  setup() {
    const store = useStore<RootState>()
    const isVisible = computed(() => store.state.panel.isPanelVisible)
    const panelData = computed(() => store.state.panel.panelData ?? [])

    return {
      isVisible,
      panelData,
    }
  },
})
</script>

<template>
  <v-navigation-drawer
    v-model="isVisible"
    right
    temporary
  >
    <v-list>
      <v-list-item v-for="item in panelData" :key="item.id">
        {{ item.name }}
      </v-list-item>
    </v-list>
  </v-navigation-drawer>
</template>
```

---

## âœ… ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ä¸Šã®æ³¨æ„ç‚¹

| å‡¦ç†        | ãƒã‚¤ãƒ³ãƒˆ                                                     |
| --------- | -------------------------------------------------------- |
| APIå‘¼ã³å‡ºã—   | **ã‚µã‚¤ãƒ‰ãƒ‘ãƒãƒ«å†…ã§ã¯è¡Œã‚ãªã„**ï¼ˆè¦ªï¼ãƒ˜ãƒƒãƒ€ãƒ¼ãªã©ã§è¡Œã†ï¼‰                           |
| ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º     | `computed(() => store.state.panel.panelData)` ã§ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«è¿½å¾“ |
| ãƒ‘ãƒãƒ«è¡¨ç¤º     | `v-if` ã‚ˆã‚Š `v-show` or `v-model` ã®æ–¹ãŒVuexã¨ã®ç›¸æ€§ãŒè‰¯ã„           |
| åˆå›è¡¨ç¤ºã®ã¿API | storeã«ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ¸ˆã¿ã‹åˆ¤å®šã™ã‚Œã°é˜²æ­¢ã§ãã‚‹ï¼ˆ`if (!state.panelData)`ï¼‰        |

---

## âœ… ç™ºå±•ï¼šAPIã‚’ä½•åº¦ã‚‚å‘¼ã³ãŸããªã„å ´åˆ

```ts
const openSidePanel = async () => {
  store.commit('panel/openPanel')

  if (!store.state.panel.panelData) {
    const res = await fetch('/api/panel-data')
    const data: MyDto[] = await res.json()
    store.commit('panel/setPanelData', data)
  }
}
```

---

## âœ… ã¾ã¨ã‚ï¼šãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã¨è²¬ä»»åˆ†æ‹…

| ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ    | è²¬ä»»                                                 |
| ---------- | -------------------------------------------------- |
| Header / è¦ª | âœ… ãƒœã‚¿ãƒ³æŠ¼ä¸‹ã‚’æ¤œçŸ¥<br>âœ… APIã‚’å‘¼ã³ã€storeã«ç™»éŒ²<br>âœ… ã‚µã‚¤ãƒ‰ãƒ‘ãƒãƒ«è¡¨ç¤ºON    |
| SidePanel  | âœ… storeã«ã‚ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’ `computed` ã§å‚ç…§ã—è¡¨ç¤ºã™ã‚‹ã ã‘ï¼ˆãƒã‚¦ãƒ³ãƒˆæ™‚ã®ãƒ­ã‚¸ãƒƒã‚¯ãªã—ï¼‰ |

---

ã”å¸Œæœ›ãŒã‚ã‚Œã°ï¼š

* ãƒœã‚¿ãƒ³æŠ¼ä¸‹å¾Œã«ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¹ãƒ”ãƒŠãƒ¼ã‚’è¡¨ç¤ºã™ã‚‹æ–¹æ³•
* ãƒ‘ãƒãƒ«ã‚’é–‰ã˜ãŸéš›ã«ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªã‚¢ã™ã‚‹æ§‹æˆï¼ˆ`setPanelData(null)`ï¼‰
* è¤‡æ•°ã®ãƒ‘ãƒãƒ«ã‚’ã‚¿ãƒ–ã”ã¨ã«ç®¡ç†ã™ã‚‹æ§‹æˆï¼ˆ`{ [tabId]: MyDto[] }`ï¼‰

ãªã©ã‚‚è¿½åŠ ã§ã”æ¡ˆå†…ã§ãã¾ã™ï¼
